namespace Spriggan.ConverterGenerators;

using System.IO;
using System.Text;

public class CFile
{
    private readonly StringBuilder _sb;
    private int _indent;

    public CFile()
    {
        _sb = new StringBuilder();
        Code("// THIS FILE IS AUTOGENERATED DO NOT EDIT BY HAND");
        Code("using System;");
        Code("using System.Text.Json;");
        Code("using System.Text.Json.Serialization;");
        Code("using System.Drawing;");
        Code( "using Mutagen.Bethesda.Skyrim;");
        Code("using Spriggan.Converters.Base;");
        Code("using Microsoft.Extensions.DependencyInjection;");
        Code("");
    }

    public void Write(string path)
    {
        File.WriteAllText(path, _sb.ToString());
    }

    public void Code(string c)
    {
        if (c.EndsWith("}"))
            _indent--;

        for (var i = 0; i < _indent; i++) _sb.Append("  ");
        _sb.AppendLine(c);

        if (c.EndsWith("{"))
            _indent++;
    }
}